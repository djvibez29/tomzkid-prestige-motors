{% extends "base.html" %}

{% block content %}

<div class="container">

    <h1 class="page-title">Available Vehicles</h1>

    <!-- SEARCH -->
    <form method="GET" action="/" class="search-form">
        <input 
            type="text" 
            name="search" 
            placeholder="Search brand or model..." 
            value="{{ request.args.get('search', '') }}"
        >
        <button type="submit">Search</button>
    </form>

    <!-- VEHICLE GRID -->
    <div class="car-grid">

        {% for car in cars %}

        <div class="car-card">

            <!-- IMAGE -->
            <a href="{{ url_for('car_page', car_id=car.id) }}">

                {% if car.images and car.images|length > 0 %}
                    <img 
                        src="{{ url_for('static', filename='uploads/' ~ car.images[0].filename) }}" 
                        alt="{{ car.brand }} {{ car.model }}"
                        class="car-image"
                    >
                {% else %}
                    <img 
                        src="{{ url_for('static', filename='no-image.png') }}" 
                        alt="No image"
                        class="car-image"
                    >
                {% endif %}

            </a>

            <!-- INFO -->
            <div class="car-info">

                <h3>{{ car.brand }} {{ car.model }}</h3>

                <!-- SAFE PRICE -->
                <p class="price">
                    {% if car.price %}
                        ₦{{ "{:,}".format(car.price|int) }}
                    {% else %}
                        Price on request
                    {% endif %}
                </p>

                <p class="meta">
                    {{ car.year or "—" }} • 
                    {{ car.body_type or "—" }} • 
                    {{ car.transmission or "—" }}
                </p>

                <!-- BUTTONS -->
                <div class="card-actions">

                    <a 
                        href="{{ url_for('car_page', car_id=car.id) }}" 
                        class="btn view-btn"
                    >
                        View Details
                    </a>

                    <a 
                        href="{{ url_for('car_page', car_id=car.id) }}#contact" 
                        class="btn enquire-btn"
                    >
                        Enquire
                    </a>

                </div>

            </div>

        </div>

        {% else %}
            <p class="empty-msg">No vehicles found.</p>
        {% endfor %}

    </div>

</div>

{% endblock %}
