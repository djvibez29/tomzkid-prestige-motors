{% extends "base.html" %}
{% block content %}

<form class="search-bar" method="get">

<input name="search" placeholder="Search..." value="{{ request.args.get('search','') }}">

<select name="brand">
<option value="">Brand</option>
{% for b in brands %}
<option value="{{b.id}}">{{b.name}}</option>
{% endfor %}
</select>

<select name="engine">
<option value="">Engine</option>
{% for e in engines %}
<option value="{{e.id}}">{{e.name}}</option>
{% endfor %}
</select>

<select name="fuel">
<option value="">Fuel</option>
{% for f in fuels %}
<option value="{{f.id}}">{{f.name}}</option>
{% endfor %}
</select>

<select name="type">
<option value="">Type</option>
{% for t in types %}
<option value="{{t.id}}">{{t.name}}</option>
{% endfor %}
</select>

<input type="number" name="min_price" placeholder="Min $">
<input type="number" name="max_price" placeholder="Max $">

<select name="sort">
<option value="">Newest</option>
<option value="price_asc">Price ↑</option>
<option value="price_desc">Price ↓</option>
</select>

<button>Apply</button>

</form>

<!-- ---------------- GRID ---------------- -->

<div class="grid">

{% for car in cars %}
<div class="car-card">

{% if car.images %}
<img src="{{ url_for('static', filename='uploads/cars/' + car.images[0].filename) }}">
{% endif %}

<h3>{{ car.title }}</h3>

<p class="price">${{ "{:,}".format(car.price) }}</p>

<div class="meta">
{{ car.brand.name }} • {{ car.engine.name }} • {{ car.fuel.name }}
</div>

<div class="card-actions">

<a href="/save/{{car.id}}" class="save-btn">
{% if car.id in saved %}
❤️ Saved
{% else %}
♡ Save
{% endif %}
</a>

</div>

</div>
{% endfor %}

</div>

<!-- ---------------- PAGINATION ---------------- -->

<div class="pagination">

{% if pagination.has_prev %}
<a href="?page={{ pagination.prev_num }}">← Prev</a>
{% endif %}

<span>Page {{ pagination.page }} of {{ pagination.pages }}</span>

{% if pagination.has_next %}
<a href="?page={{ pagination.next_num }}">Next →</a>
{% endif %}

</div>

{% endblock %}
